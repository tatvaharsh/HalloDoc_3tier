@model hallodoc_mvc_Repository.ViewModel.Order;
@{
    ViewData["Title"] = "Send Order";
    Layout = "_LayAdmin";
}


<style>
    .footer{position:fixed;}

    .nav-underline .nav-link.active {
        color: #5bc0de !important;
    }
</style>
@await Html.PartialAsync("_Admin_Header_Dashboard")
<div class="container">
    <div class=" mt-5 d-flex justify-content-between align-items-center">
        <h4> Send Order </h4>



        <a asp-controller="Admin" asp-action="Admin_Dashboard"
           class="btn shadow  btn-outline-secondary border-info text-info px-3 ">
            <i class="fa-solid fa-angle-left"></i> Back
        </a>
    </div>
    <form action="" class="shadow border rounded my-3" method="post">
        <div class="mx-3 my-4 ">
            <div class="mt-3">



                <div class="mt-1">
                    <div class="row">
                        <div class="col col-12 col-sm-6">
                            <select class="form-select  text-secondary" aria-label="Narrow search by region" onchange="get(this.value)" style="width:100%; height:calc(3.5rem + calc(var(--bs-border-width) * 2));">
                                <option selected>Select Profession</option>
                                @foreach (var item in Model.HealthProfessionalType)
                                {
                                    <option value="@item.HealthProfessionalId">@item.ProfessionName</option>
                                }
                            </select>
                        </div>
                   

                        <div class="col col-12 col-sm-6">
                            <select class="selectpicker form-control   mb-3 col-12 col-sm-6" style="width:100%; height:calc(3.5rem + calc(var(--bs-border-width) * 2));" onchange="getdetail(this.value)" aria-label="Select Vendor" id="vendor" asp-for="SelectedVendorId">

                            </select>
                        </div>
                      


                    </div>
                    <div class="row">

                        <div class="form-floating mb-3 col-12 col-sm-6">
                            <input type="tel" class="form-control floatingInput" id="contact" asp-for="Businesscontact" placeholder="Business Contact" >
                            <label for="floatingInput " class="mx-2">Business Contact</label>
                        </div>

                        @*DSG*@

                        <div class="form-floating mb-3 col-12 col-sm-6">
                            <input type="email" class="form-control emailInp dclass" asp-for="Email" id="email">
                            <label for="floatingInput" class="mx-2 ">Email</label>
                        </div>
                       
                    </div>

                    <div class="row">
                        <div class="form-floating mb-3 col-12 col-sm-6">
                            <input type="text" class="form-control floatingInput" id="fax" asp-for="Fax" placeholder="Fax">
                            <label for="floatingInput " class="mx-2">Fax Number</label>
                        </div>

                    </div>

                    <div class="row">
                        <div class="form-floating">
                            <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea2" asp-for="Detail" style="height: 100px"></textarea>
                            <label for="floatingTextarea2" class="mx-2">Presciption of Order details</label>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col col-12 col-sm-6">
                            <select class="selectpicker form-control   mb-3 col-12 col-sm-6" asp-for="refill" style="width:100%; height:calc(3.5rem + calc(var(--bs-border-width) * 2));">
                                <option selected>Number of Refill </option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                             

                            </select>
                        </div>
                    </div>
                  
                   
                    
                   

                </div>


               
                <div class="d-grid gap-2 d-flex justify-content-center  justify-content-md-end mt-4 pt-4 mb-3">
                    <button type="submit" class="btn text-white btn-info">Submit</button>

                    <button type="button" class="btn  btn-outline-info">Cancel</button>



                </div>

            </div>
        </div>
    </form>
</div>

<partial name="_Footer" />

<script>
    function get(id) {
        $.ajax({
            url: '/Admin/GetVendor',
            data: { id: id },
            success: function (data) {
                console.log(data);
                if (data) {
                    var content = "";
                    if (data.length == 0) {
                        console.log("break");
                        content += `<option selected>Business</option>`;
                    }
                    else if (Array.isArray(data)) {
                        for (const item of data) {
                            content += `<option value="${item.vendorId}">${item.vendorName}</option>`;
                        }
                        console.log(content);
                    } else {
                        console.error('Unexpected data format: Received data is not an array of strings.');
                    }

                    $('#vendor').html(content);
                    getdetail(data[0].vendorId)
                } else {
                    var content = `<option disabled selected class="d-none"> Select Physician </option>`;


                    $('#vendor').html(content);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error('AJAX Error:', textStatus, errorThrown);
            }
        });
    }


    function getdetail(id) {
        $.ajax({
            url: '/Admin/Getdetails',
            data: { id: id },
            success: function (data) {
                console.log(data);
                if (data) {
                    var content = "";
                    if (data.length == 0) {
                        console.log("break");
                        content += `<option selected>Select Vendor</option>`;
                    }
                    else if (Array.isArray(data)) {
                        for (const item of data) {
                            var num = item.businessContact;
                            var email = item.email;
                            var fax = item.faxNumber;
                        }
                        
                    } else {
                        console.error('Unexpected data format: Received data is not an array of strings.');
                    }

                    $('#contact').val(num);
                    $('#email').val(email);
                    $('#fax').val(fax);
                } else {
                    var content = `<option disabled selected class="d-none"> Select Physician </option>`;


                    $('#vendor').html(content);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error('AJAX Error:', textStatus, errorThrown);
            }
        });
    }
</script>