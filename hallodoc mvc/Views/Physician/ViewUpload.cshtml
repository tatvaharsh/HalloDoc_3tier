@model IEnumerable<hallodoc_mvc_Repository.ViewModel.ViewDocument>@{    ViewData["Title"] = "View Uploads";
    Layout = "~/Views/Shared/Physician/_LayPhysician.cshtml";}<link href="~/css/Admin_Pages/ViewCase.css" rel="stylesheet" type="text/css" /><link href="~/css/Admin_Pages/Admin_Dashboard.css" rel="stylesheet" type="text/css" /><!-- main-container --><Partial name="_Toast" /><!-- main-container --><div class="container p-sm-2 p-md-5">    <div class="tab-content" id="myTabContent">        <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"            tabindex="0">            <div class=" mt-2 d-flex justify-content-between align-items-center">                <h4>Document</h4>                <a asp-controller="Physician" asp-action="PhysicianDashboard" class="btn shadow  btn-outline-secondary border-info text-info px-3 ">                    <i class="fa-solid fa-angle-left"></i> Back                </a>            </div>            <div class="container-fluid shadow border rounded mt-3 px-4 mb-5 pb-5">                <div class="text-secondary pt-3 my-2">Patient Name</div>                <span class="text-info fs-4 my-2">@Model.FirstOrDefault().FirstName</span> <span class="my-2 text-secondary">                    (@Model.FirstOrDefault().Confirmationnumber)                </span>                <div class="my-2 text-secondary">                    Check here to review and add files that you or the Client/Member has attached to the request.                </div>                <form asp-action="FileUpload" asp-controller="Physician" asp-route-id="@Model.FirstOrDefault().RequestId" enctype="multipart/form-data">                    <div class="input-group mb-3  rounded my-4">                        <input type="file" asp-for="@Model.FirstOrDefault().File" onchange="getFileData(this)" class="form-control  py-3" id="inputGroupFile" multiple>                        <button type="submit" class="input-group-text fw-bold bg-info upload">                            <i class="bi bi-cloud-arrow-up me-2 fw-bold text-white"></i>                            <span class="text-white">Upload</span>                        </button>                    </div>                </form>                <div class="d-flex justify-content-end">                    <div class="text-end pt-3 pe-0 mb-4 ms-3">                        <a  onclick="downloadFile()" class="btn btn-outline-dark border-info rounded-2 p-2 text-info downloadAll" >                            <span class="d-none d-sm-inline-block">Download All</span>                            <span class="d-inline-block d-sm-none"><i class="bi bi-download text-info"></i></span>                        </a>                    </div>                    <div class="text-end pt-3 pe-0 mb-4 ms-3">                                           <a onclick="deleteFile()" class="btn btn-outline-dark border-info rounded-2 p-2 text-info downloadAll">                            <span class="d-none d-sm-inline-block">Delete All</span>                            <span class="d-inline-block d-sm-none"><i class="fa-solid fa-trash"></i></span>                        </a>                    </div>                    <div class="text-end pt-3 pe-0 mb-4 ms-3">                        <a asp-action="SendEmail" asp-route-id="@Model.FirstOrDefault()?.RequestId" class="btn btn-outline-dark border-info rounded-2 p-2 text-info downloadAll">                            <span class="d-none d-sm-inline-block">Send All</span>                            <span class="d-inline-block d-sm-none"><i class="fa-regular fa-envelope"></i></span>                        </a>                    </div>                </div>                <div class="container-fluid table-responsive">                    <table class="table d-none d-md-table">                        <thead class="bg-body-tertiary ">                            <thead>                                <tr>                                    <th>                                    <input type="checkbox" class="checkboxes" id="checkall" name="selectall"  onchange="oncheck()" />                                    </th>                                    <th>Documents</th>                                    <th>Upload Date</th>                                    <th>Actions</th>                                </tr>                            </thead>                             <tbody>                                @if (Model.FirstOrDefault().FileName != null)
                                {
                                    
                                                              @foreach (var obj in Model)                            {                                <tr class="align-middle">                                    <td>                                            <input type="checkbox" name="Mark" class="checkboxes fileCheckbox Subcheckbox" data-filename="@obj.FileName" data-fileid="@obj.FileId" value="@obj.FileId" />                                    </td>                                    <td>@obj.FileName</td>                                    <td>@obj.Uploaddate</td>                                    <td>                                            <a type="button" asp-controller="Home" asp-action="Download" asp-route-id="@obj.FileId" class="btn                                                         download-btn border-info text-info">                                                <i class="bi bi-cloud-arrow-down"></i>                                            </a>                                            <a type="button" asp-action="DeleteFile" asp-route-id="@obj.FileId" class="btn btn-outline-info back-btn">                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">                                                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z" />                                                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z" />                                                </svg>                                            </a>                                    </td>                                </tr>                            }                                }                            </tbody>                     </table>                    <div class="d-md-none border-top">                        @foreach (var item in Model)
                        {                            <div>                                <input type="checkbox" name="Mark" class="checkboxes fileCheckbox Subcheckbox" data-filename="@item.FileName" data-fileid="@item.FileId" value="@item.FileId" />                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-check-fill text-danger" viewBox="0 0 16 16">                                    <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1m1.354 4.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708.708" />                                </svg>                                @item.FileName                            </div>                            <div class="py-2">                                @Html.DisplayFor(x=>item.Uploaddate)                            </div>                            <div class="mb-2 pb-2 border-bottom">                                <a type="button" asp-action="Download" asp-controller="Home" asp-route-id="@item.FileId" class="btn btn-outline-info back-btn">                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-arrow-down-fill" viewBox="0 0 16 16">                                        <path d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5" />                                    </svg>                                </a>                                <a type="button" asp-action="DeleteFile" asp-route-id="@item.FileId"  class="btn btn-outline-info back-btn">                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-minus-fill" viewBox="0 0 16 16">                                        <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1M6 8.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1 0-1" />                                    </svg>                                </a>                            </div>                        }                    </div>                </div>            </div>        </div>    </div></div><partial name="_Footer" /><style>.foot{    position: fixed;}</style>@section Scripts {    <script>        //$('.downloadAll').click(function () {        //    $('.fileCheckbox:checked').each(function () {        //        var filePath = $(this).closest('tr').find('.download-btn')[0].click();        //    });        //});        const getFileData = (myFile) => {            var file = myFile.files[0];            var filename = file.name;            document.getElementById("form-label").innerHTML = `${filename}`;        }                function oncheck() {            var check = document.getElementById('checkall').checked;            if (check) {                var len = document.getElementsByClassName('checkboxes');                for (var i = 0; i < len.length; i++) {                    len[i].checked = true;                }            } else {                var len = document.getElementsByClassName('checkboxes');                for (var i = 0; i < len.length; i++) {                    len[i].checked = false;                }            }            console.log(check);        }        function downloadFile() {            var checkboxes = document.querySelectorAll('.Subcheckbox:checked');            var filenames = [];            checkboxes.forEach(function (checkbox) {                filenames.push(checkbox.getAttribute('data-filename'));            });            if (filenames.length > 0) {                var xhr = new XMLHttpRequest();                xhr.open('POST', '/Physician/DownloadFiles/@Model.FirstOrDefault()?.RequestId', true);                xhr.setRequestHeader('Content-Type', 'application/json');                xhr.responseType = 'blob';                xhr.onload = function () {                    if (this.status === 200) {                        var blob = new Blob([this.response], { type: 'application/octet-stream' });                        var link = document.createElement('a');                        link.href = window.URL.createObjectURL(blob);                        link.download = 'selected_files.zip';                        link.click();                    }                };                xhr.send(JSON.stringify(filenames));            } else {                alert('Please select one or more files to download.');            }        }        function deleteFile() {            var checkboxes = document.querySelectorAll('.Subcheckbox:checked');            var filenames = [];                     var i=0;            checkboxes.forEach(x=>{                filenames[i] = x.value;                i++;            });            $.ajax({                url: '/Physician/deletefilecus',                type: 'POST',                data: {id: @Model.FirstOrDefault()?.RequestId, filenames: filenames },                success: function (response) {                    var link=document.createElement('a');                    link.href = '/Physician/ViewUpload/' + @Model.FirstOrDefault()?.RequestId;                    document.body.appendChild(link);                    link.click();                    document.body.removeChild('link');                },                error: function () {                    alert('An error occurred.');                }            });        }    </script>    }